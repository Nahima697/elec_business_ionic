<ion-content [fullscreen]="true" class="bg-gray-50">

  <!-- Conteneur principal: Centré et adapté pour mobile/desktop -->
  <div class="w-full max-w-5xl mx-auto flex flex-col items-center justify-center p-0 md:p-8">

    <!-- 1. En-tête (Visible sur mobile uniquement) -->
    <ion-header class="ion-no-border w-full md:hidden">
      <ion-toolbar class="bg-[var(--color-primary)] text-white">
        <ion-title>Elec Business</ion-title>
      </ion-toolbar>
    </ion-header>

    <!-- 2. Section Auth Card (Split View sur Desktop, Stacked sur Mobile) -->
    <div class="w-full md:flex md:flex-row md:items-stretch bg-white shadow-xl rounded-2xl overflow-hidden m-0 md:m-4">

      <!-- A. Bloc Visuel (Gauche sur Desktop, Haut sur Mobile avec dégradé) -->
      <div class="w-full md:w-5/12 flex justify-center items-center p-4
                  bg-gradient-to-br from-green-400 to-cyan-400
                  md:rounded-l-2xl">

        <div class="flex flex-col items-center p-4">
          <!-- Illustration -->
          <img src="assets/images/hero_img.png"
               alt="Illustration de voiture électrique"
               class="h-40 w-auto object-contain z-10 md:h-64"
          />
          <!-- Titre visible uniquement sur Desktop -->
          <h1 class="hidden md:block text-2xl font-bold text-white tracking-wide mt-4 text-center">
            Rejoignez<br>Elec Business
          </h1>
        </div>
      </div>

      <!-- B. Bloc Formulaire (Droite sur Desktop) -->
      <div class="w-full md:w-7/12 p-6 sm:p-8 flex flex-col justify-center">

        <header class="mb-6 text-center md:text-left">
          <h2 class="text-3xl font-bold text-[var(--color-foreground)]">
            Inscription
          </h2>
          <p class="text-base text-[var(--color-secondary)] mt-1">
            Créez votre compte en quelques étapes.
          </p>
        </header>

        <ion-card-content class="p-0">
          <!-- Formulaire d'Inscription -->
          <form [formGroup]="registerForm" (ngSubmit)="onSubmit()" class="flex flex-col space-y-0">

            <!-- Username -->
            <app-form-field
              label="Nom d'utilisateur"
              placeholder="Votre identifiant"
              [controlType]="ControlType.Input"
              [formControl]="username"
              type="text">
            </app-form-field>

            <!-- Email -->
            <app-form-field
              label="Email"
              placeholder="Votre email professionnel"
              [controlType]="ControlType.Input"
              [formControl]="email"
              type="email">
            </app-form-field>

            <!-- Password -->
            <app-form-field
              label="Mot de passe"
              placeholder="Minimum 8 caractères"
              [controlType]="ControlType.Input"
              [formControl]="password"
              type="password">
            </app-form-field>

            <!-- Confirm Password -->
            <app-form-field
              label="Confirmer le mot de passe"
              placeholder="Retapez votre mot de passe"
              [controlType]="ControlType.Input"
              [formControl]="confirmPassword"
              type="password">
            </app-form-field>
          @if (registerForm.hasError('passwordMismatch') && (confirmPassword.touched || confirmPassword.dirty)) {
                <p class="text-xs text-red-500 mt-1 absolute -bottom-5 left-0">
                  Les mots de passe ne correspondent pas.
                </p>
          }
            <!-- Checkbox CGU -->
            <div class="py-2">
              <ion-item lines="none" class="flex items-center justify-start --padding-start-0">
                <ion-checkbox slot="start" color="primary" class="mr-2"></ion-checkbox>
                <ion-label class="text-sm text-[var(--color-foreground)] whitespace-normal">
                  J'accepte les
                  <a href="#" class="text-[var(--color-primary)] font-medium hover:underline">Conditions Générales d'Utilisation</a>
                </ion-label>
              </ion-item>
            </div>

            <!-- Bouton Valider -->
             <div class="mt-6 space-y-4">
            <ion-button
              type="submit"
              expand="block"
              class="h-12 --box-shadow-none"
              color="primary"
              shape="round"
              [disabled]="registerForm.invalid || isLoading"
            >
              @if(isLoading) {
                <ion-spinner name="crescent" color="light"></ion-spinner>
              } @else {
                S'inscrire
              }
            </ion-button>
            </div>
          </form>

          <!-- Déjà inscrit ? -->
          <div class="mt-8 text-center text-sm text-[var(--color-secondary)]">
            Déjà un compte ?
            <a routerLink="/login" class="text-[var(--color-primary)] font-semibold hover:underline">
              Se connecter
            </a>
          </div>

        </ion-card-content>
      </div>
    </div>
  </div>
</ion-content>
