


<ion-content [fullscreen]="true" class="bg-gray-50">

  <div class="w-full max-w-5xl mx-auto flex flex-col items-center justify-center p-0 md:p-8">

    <ion-header class="ion-no-border w-full md:hidden">
      <ion-toolbar class="bg-[var(--color-primary)] text-white">
        <ion-title>Elec Business</ion-title>
      </ion-toolbar>
    </ion-header>

    <div class="w-full md:flex md:flex-row md:items-stretch bg-white shadow-xl rounded-2xl overflow-hidden m-0 md:m-4">

      <!-- Bloc gauche -->
      <div class="w-full md:w-5/12 flex justify-center items-center p-4
                  bg-gradient-to-br from-green-400 to-cyan-400
                  md:rounded-l-2xl">

        <div class="flex flex-col items-center p-4">
          <img src="assets/images/hero_img.png"
               alt="Illustration de voiture électrique"
               class="h-40 w-auto object-contain z-10 md:h-64" />

          <h1 class="hidden md:block text-2xl font-bold text-white tracking-wide mt-4 text-center">
            Réinitialisez<br>votre mot de passe
          </h1>
        </div>
      </div>

      <!-- Bloc formulaire -->
      <div class="w-full md:w-7/12 p-6 sm:p-8 flex flex-col justify-center">

        <header class="mb-6 text-center md:text-left">
          <h2 class="text-3xl font-bold text-[var(--color-foreground)]">
            Réinitialisation
          </h2>
          <p class="text-base text-[var(--color-secondary)] mt-1">
            Entrez votre nouveau mot de passe.
          </p>
        </header>

        <ion-card-content class="p-0">

          <!-- Message succès -->
          @if(successMessage) {
            <div class="bg-green-100 text-green-700 p-3 rounded-lg mb-4 text-sm">
              {{ successMessage }}
            </div>
          }

          <!-- Message erreur -->
          @if(errorMessage) {
            <div class="bg-red-100 text-red-700 p-3 rounded-lg mb-4 text-sm">
              {{ errorMessage }}
            </div>
          }

          <form [formGroup]="resetPasswordForm"
                (ngSubmit)="onSubmit()"
                class="flex flex-col space-y-6">

            <!-- Password -->
            <div class="relative">
              <app-form-field
                label="Mot de passe"
                placeholder="Minimum 8 caractères"
                [controlType]="ControlType.Input"
                [formControl]="password"
                type="password">
              </app-form-field>
            </div>

            <!-- Confirm Password -->
            <div class="relative">
              <app-form-field
                label="Confirmer le mot de passe"
                placeholder="Retapez votre mot de passe"
                [controlType]="ControlType.Input"
                [formControl]="confirmPassword"
                type="password">
              </app-form-field>

              @if (resetPasswordForm.hasError('passwordMismatch') &&
                    (confirmPassword.touched || confirmPassword.dirty)) {
                <p class="text-xs text-red-500 mt-1">
                  Les mots de passe ne correspondent pas.
                </p>
              }
            </div>

            <!-- Bouton -->
            <ion-button
              type="submit"
              expand="block"
              class="h-12 shadow-none"
              color="primary"
              shape="round"
              [disabled]="resetPasswordForm.invalid || isLoading">

              @if(isLoading) {
                <ion-spinner name="crescent" color="light"></ion-spinner>
              } @else {
                Réinitialiser le mot de passe
              }

            </ion-button>

          </form>
        </ion-card-content>
      </div>
    </div>
  </div>
</ion-content>
